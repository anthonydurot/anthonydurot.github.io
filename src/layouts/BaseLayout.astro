---
import ThemeToggle from '../components/ThemeToggle.astro';

interface Props {
  title: string;
  description?: string;
  loadMermaid?: boolean;
}

const { title, description = "Backend Engineer Portfolio", loadMermaid = false } = Astro.props;
---

<!doctype html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="description" content={description} />
    <title>{title}</title>

    <script is:inline>
      const theme = (() => {
        if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
          return localStorage.getItem('theme');
        }
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          return 'dark';
        }
        return 'light';
      })();
      if (theme === 'dark') {
        document.documentElement.classList.add('dark');
      }
    </script>
  </head>
  
  <body class="bg-slate-50 text-slate-900 dark:bg-[#0B1120] dark:text-slate-100 min-h-screen flex flex-col font-sans transition-colors duration-300">
    
    <header class="sticky top-0 z-40 w-full border-b border-slate-200 dark:border-slate-800 bg-white/80 dark:bg-[#0B1120]/80 backdrop-blur-md">
      <nav class="max-w-3xl mx-auto flex justify-between items-center p-4">
        <a href="/" class="font-bold text-lg tracking-tight hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
          ~/portfolio
        </a>
        
        <div class="flex items-center gap-6 text-sm font-medium text-slate-600 dark:text-slate-400">
          <a href="/blog" class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Blog</a>
          <a href="/about" class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors">About</a>
          <ThemeToggle />
        </div>
      </nav>
    </header>

    <main class="flex-1 w-full max-w-3xl mx-auto p-4 md:py-12 relative z-0">
      <slot />
    </main>

    <footer class="border-t border-slate-200 dark:border-slate-800 mt-12 py-8 text-center text-sm text-slate-500 dark:text-slate-400">
      <p>&copy; {new Date().getFullYear()} Backend Engineer. Built with Astro.</p>
    </footer>

    {loadMermaid && (
      <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        const isDark = document.documentElement.classList.contains('dark');
        mermaid.initialize({ startOnLoad: true, theme: isDark ? 'dark' : 'neutral' });
      </script>
    )}
  </body>
</html>